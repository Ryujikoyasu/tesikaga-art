# お花の池、小鳥の森

![弟子屈での実演](assets/movie/demo.gif)

*▲ 弟子屈町での実際の動作風景。来場者の動きに反応して光の鳥が舞い踊る*

弟子屈町のためのインタラクティブアート作品です。町花であるエゾイソツツジをモチーフに制作した蓄光オブジェを池に浮かべ、LEDテープとスピーカーで弟子屈らしい８種類の小鳥の存在を宿しました。

来場者の動きを検知し、その存在が「小鳥」として表現される光と音の群れに影響を与えます。テクノロジーを通じて、**人と自然の、繊細で詩的な関わり合い**を体験していただくことを目指しています。

## 🎯 こだわりポイント

### シミュレーションと現実の100%同期
WS2811 LEDテープ（3LED=1ピクセル）の制約に合わせてソフトウェアを設計。PC画面で見えるものが、そのまま物理世界で再現されます。楕円形の池の中心を原点とした座標系を設置し、LiDARとのキャリブレーションを実施。ガラスの浮き玉を座標が既知の場所に配置し、LEDテープの始点と終点を合わせることで、シミュレーション環境上のテープ配置と現実世界の配置の誤差を最小限に抑えました。

### 光に「生命感」を宿すAI
- **1D縄張り意識**: 鳥は2D空間を自由に動きながら、LEDテープ上での他の鳥との距離を監視。重なりを予測して回避することで、不自然な混色を防止

### 創造性を支える自動化
- **音と光の共演**: 音声解析により光の明滅パターンを自動生成
- **アーティストの筆跡**: マウスで描いた曲線を物理制約に合わせて自動調整

## 🚀 セットアップ

### 1. 環境準備
```bash
pip install -r requirements.txt
```

### 2. Arduino設定
- Arduino Uno R4にFastLEDライブラリをインストール
- `arduino/fastled.ino`で`NUM_PHYSICAL_LEDS`、`DATA_PIN`を設定
- WS2811 LEDテープ用の設定でスケッチを書き込み

### 3. プロジェクト設定
`settings.yaml`でシリアルポートなど環境設定を調整

### 4. ビルド手順（重要）
```bash
# LEDレイアウト生成（初回・デザイン変更時）
python scripts/artistic_path_generator.py

# 設定ファイル生成（初回・音声/鳥パラメータ変更時）
python scripts/audio_sync_generator.py
```

### 5. 実行
```bash
# シミュレーションのみ
python main.py

# 物理LEDと連携
python main_real.py
```

## 📁 アーキテクチャ

各コンポーネントが明確な役割を持つ「関心の分離」設計：

- **main.py**: オーケストラの指揮者
- **objects.py**: 鳥・人間のAI
- **simulation.py**: 物理世界の管理
- **renderer.py**: 描画・表現ロジック
- **input_source.py**: マウス・LiDAR入力の抽象化
- **serial_handler.py**: Arduino通信（バックグラウンド処理）
- **coordinates.py**: 座標変換の一元管理

## 🎵 弟子屈らしい８種類の鳥たち

- **クマゲラ** (深い濃紺の光)
- **オオハクチョウ** (純白の光)
- **オジロワシ** (力強い黄金の光)
- **タンチョウ** (優雅な赤と白)
- **ベニマシコ** (温かな紅色)
- **シマフクロウ** (神秘的な茶色)
- **オルリ** (鮮やかな青)
- **ノゴマ** (オレンジ色の光)

それぞれ固有の色彩、鳴き声、行動パターンを持ち、音声解析による光の同期パターンも自動生成されます。